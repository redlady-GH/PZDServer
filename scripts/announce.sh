#!/bin/bash
# -----------------------------------------------------------------------------
# [스크립트 설명]
# 서버에 접속해 있는 모든 플레이어에게 공지사항(메시지)을 전송합니다.
# 화면 중앙에 텍스트가 표시되므로 긴급 점검이나 안내 시 유용합니다.
#
# [사용 방법]
# ./announce.sh "보낼 메시지 내용"
# 예: ./announce.sh "잠시 후 3시에 서버 점검이 있습니다."
# -----------------------------------------------------------------------------

if [ -z "$1" ]; then
    echo "❌ 오류: 메시지 내용이 없습니다."
    echo "사용법: $0 \"메시지 내용\""
    exit 1
fi

MESSAGE="$1"

# 'screen' 명령어를 통해 실행 중인 'pzserver' 세션에 메시지를 주입합니다.
# servermsg 명령어는 게임 내 채팅창과 화면에 메시지를 띄웁니다.
sudo -u steam screen -S pzserver -X stuff "servermsg \"$MESSAGE\"\n"

echo "✅ 공지 전송 완료: $MESSAGE"
